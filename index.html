<html>
 <head>
  <title>HTML Pad Preview</title>
  <link rel="stylesheet" href="style.css" type="text/css"/>
  <script type="text/javascript" src="jquery-1.10.2.js"></script>
 </head>
 <body>
  <p id="head">
   Source:
   <span id="url"></span>
   <input type="button" onclick="loadPad();" value="Refresh"></input> 
  </p>
  <div id="preview"></div>
 </body>
 <script type="text/javascript">
var loadPad = function(){
 var padUrl = window.location.search.substring(1)
     htmlUrl = padUrl + "/export/html";
 if (padUrl) {
  $("#url").html('<a href="'+padUrl+'">'+padUrl+"</a>");
  if (padUrl.search("/p/") == -1)
   htmlUrl = padUrl.replace(/\/([^\/]*)$/, "/ep/pad/export/$1/latest?format=txt");
  $.get(
   htmlUrl,
   function(data){
    data = data.replace(/\n/g, "")
     .replace(/^.*<body>/, "")
     .replace(/<\/body>.*$/, "")
     .replace(/(<br>|\s)*<em>[^<]*<\/em>(<br>|\s)*/, " ")
     .replace(/p&gt;(<br>|\s)*&lt;p/g, "p&gt;&lt;p")
     .replace(/<br>/g, "&lt;br/&gt;")
     .replace(/<[^>]*>/g, "")
     .replace(/&lt;/g, "<")
     .replace(/&gt;/g, ">")
     .replace(/&#x2F;/g, "/");
    $("#preview").html(data);
   },
   "html"
  );
 }
};
$(document).ready(loadPad);
 </script>
</html>
